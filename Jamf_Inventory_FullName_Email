############################################################################
# Script to prompt users for their first and last names and emails addresses
# Then submits this info to jamf computer record
# Use Parameter $4 in Jamf for the company name, $5 for the email example (yourname@company.com)
# Copyright Brooke Burdick
# October 2023
############################################################################


#!/bin/bash
#current user name in case
currentUser=$( /usr/bin/stat -f "%Su" /dev/console )

#initial info banner
banner='display dialog "$4 needs to update your Mac Inventory Record in Jamf. Please complete the following prompts." with title "Inventory Update Needed" with icon posix file "/System/Library/CoreServices/CoreTypes.bundle/Contents/Resources/UserUnknownIcon.icns"'

/usr/bin/osascript -e "$banner"

#function for prompting users to get variables
getUserInput()
{
	launchctl asuser $(stat -f %u /dev/console) osascript <<-APPLESCRIPT
	tell app "System Events"
	text returned of (display dialog "$1" default answer "" buttons {"Cancel", "Submit"} default button 2 cancel button 1)
	end tell
	APPLESCRIPT
}

#prompt for variables
realName=$(getUserInput "What is your full name? First Last")
emailAddress=$(getUserInput "What is your full work email address? Example: $5")

#Send the user's name and email address to the Mac's inventory record. Use double quotes for realName to capture first and last name entered by the user.
/usr/local/bin/jamf recon -realname "$realName"
/usr/local/bin/jamf recon -email $emailAddress

#thank you message
thanks='display dialog "Your computer record has updated." with title "Thank you!" with icon posix file "/System/Library/CoreServices/CoreTypes.bundle/Contents/Resources/ToolbarFavoritesIcon.icns"'
/usr/bin/osascript -e "$thanks"
